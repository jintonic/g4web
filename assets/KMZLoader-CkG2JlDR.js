import{a4 as d,a6 as l,a as p,G as f}from"./vendor-three-cPJTOjbb.js";import{ColladaLoader as c}from"./ColladaLoader-BJ_FaUbm.js";import{u as m}from"./vendor-editor-SgCfGT6Z.js";import"./vendor-libs-B2226kbd.js";class h extends d{constructor(t){super(t)}load(t,s,n,r){const e=this,o=new l(e.manager);o.setPath(e.path),o.setResponseType("arraybuffer"),o.setRequestHeader(e.requestHeader),o.setWithCredentials(e.withCredentials),o.load(t,function(a){try{s(e.parse(a))}catch(i){r?r(i):console.error(i),e.manager.itemError(t)}},n,r)}parse(t){function s(e){for(const o in r)if(o.slice(-e.length)===e)return r[o]}const n=new p;n.setURLModifier(function(e){const o=s(e);if(o){console.log("Loading",e);const a=new Blob([o.buffer],{type:"application/octet-stream"});return URL.createObjectURL(a)}return e});const r=m(new Uint8Array(t));if(r["doc.kml"]){const o=new DOMParser().parseFromString(new TextDecoder().decode(r["doc.kml"]),"application/xml").querySelector("Placemark Model Link href");if(o)return new c(n).parse(new TextDecoder().decode(r[o.textContent]))}else{console.warn("KMZLoader: Missing doc.kml file.");for(const e in r)if(e.split(".").pop().toLowerCase()==="dae")return new c(n).parse(new TextDecoder().decode(r[e]))}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new f}}}export{h as KMZLoader};
