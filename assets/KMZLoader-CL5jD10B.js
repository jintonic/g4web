import{L as d,F as l,ab as p,u as f,G as m}from"./main-z5BJ3CM8.js";import{ColladaLoader as i}from"./ColladaLoader-Bc4QJg_e.js";class g extends d{constructor(t){super(t)}load(t,s,r,n){const e=this,o=new l(e.manager);o.setPath(e.path),o.setResponseType("arraybuffer"),o.setRequestHeader(e.requestHeader),o.setWithCredentials(e.withCredentials),o.load(t,function(a){try{s(e.parse(a))}catch(c){n?n(c):console.error(c),e.manager.itemError(t)}},r,n)}parse(t){function s(e){for(const o in n)if(o.slice(-e.length)===e)return n[o]}const r=new p;r.setURLModifier(function(e){const o=s(e);if(o){console.log("Loading",e);const a=new Blob([o.buffer],{type:"application/octet-stream"});return URL.createObjectURL(a)}return e});const n=f(new Uint8Array(t));if(n["doc.kml"]){const o=new DOMParser().parseFromString(new TextDecoder().decode(n["doc.kml"]),"application/xml").querySelector("Placemark Model Link href");if(o)return new i(r).parse(new TextDecoder().decode(n[o.textContent]))}else{console.warn("KMZLoader: Missing doc.kml file.");for(const e in n)if(e.split(".").pop().toLowerCase()==="dae")return new i(r).parse(new TextDecoder().decode(n[e]))}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new m}}}export{g as KMZLoader};
