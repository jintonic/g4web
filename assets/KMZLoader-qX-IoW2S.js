import"./three-module-BI8WDeO_.js";import{ColladaLoader as c}from"./ColladaLoader-uiBEis6n.js";import{u as d}from"./three-editor-CgUf__d2.js";import{a4 as l,a6 as p,a as f,G as m}from"./three-core-BBimCphi.js";class h extends l{constructor(t){super(t)}load(t,s,n,r){const e=this,o=new p(e.manager);o.setPath(e.path),o.setResponseType("arraybuffer"),o.setRequestHeader(e.requestHeader),o.setWithCredentials(e.withCredentials),o.load(t,function(a){try{s(e.parse(a))}catch(i){r?r(i):console.error(i),e.manager.itemError(t)}},n,r)}parse(t){function s(e){for(const o in r)if(o.slice(-e.length)===e)return r[o]}const n=new f;n.setURLModifier(function(e){const o=s(e);if(o){console.log("Loading",e);const a=new Blob([o.buffer],{type:"application/octet-stream"});return URL.createObjectURL(a)}return e});const r=d(new Uint8Array(t));if(r["doc.kml"]){const o=new DOMParser().parseFromString(new TextDecoder().decode(r["doc.kml"]),"application/xml").querySelector("Placemark Model Link href");if(o)return new c(n).parse(new TextDecoder().decode(r[o.textContent]))}else{console.warn("KMZLoader: Missing doc.kml file.");for(const e in r)if(e.split(".").pop().toLowerCase()==="dae")return new c(n).parse(new TextDecoder().decode(r[e]))}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new m}}}export{h as KMZLoader};
